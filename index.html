<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style-home.css">
    <link rel="stylesheet" href="icon/bootstrap-icons.css">
    <title>Películas</title>
    <script src="js/jquery.js"></script>
</head>
<body style="background: rgb(55, 59, 105);">
   
    <header id="include-header"></header>
    <nav class="next" id="nav"></nav>
    <div class="anuncios" id="anuncio-ba">
        <script type="text/javascript">
            atOptions = {
                'key' : '51b15bb786ead3ee88ddd1879659deaf',
                'format' : 'iframe',
                'height' : 50,
                'width' : 320,
                'params' : {}
            };
            document.write('<scr' + 'ipt type="text/javascript" src="http' + (location.protocol === 'https:' ? 's' : '') + '://recordfunny.com/51b15bb786ead3ee88ddd1879659deaf/invoke.js"></scr' + 'ipt>');
        </script>
    </div>
    <div class="include-main" id="include-main">
        <div class="co-cards" id="co-cards"></div>
    </div>
   

<script>
//db
const contentCards = document.getElementById("co-cards")

document.addEventListener('DOMContentLoaded', () => {
    fetchData();
});
const fetchData = async () => {
    try{
        const res = await fetch('https://loadigital.github.io/movies.biloa/js/api_db.json');
        const data = await res.json();
        movies(data);
    }catch (error) {
        console.log(error);
    };
};
const movies = data =>{
data.forEach(function(data) {
        console.log(data);
if(data.tipo === "Pelicula"){

const  API_KEY  =  'api_key=d092eba29fbb5fe6130283f8e1934752' ;
const  BASE_URL  =  'https://api.themoviedb.org/3' ;
const  API_URL  =  BASE_URL  +  '/movie/' + data.id_POST + '?' + API_KEY + '&language=es-ES';//CODIGO TMBD
const  IMG_URL  =  'https://image.tmdb.org/t/p/w500' ;

getMovie(API_URL);

function getMovie(url){
    fetch(url).then(res => res.json()).then(datos =>{
        console.log(datos)
        pintar(datos);
    });
};

function pintar(datos){
    const moonLanding = new Date(datos.release_date);
    let año = moonLanding.getFullYear();

    const cards = document.createElement("div");
                cards.className ="category"
                cards.dataset.category = datos.genres[0].name;
                cards.dataset.año = año;
                cards.innerHTML=`
                <div class="cards">
                <div class="img-cards"><a href="${data.posterLink.link_web}"><img src="${IMG_URL + datos.poster_path}" alt=""></a></div>
                <div class="title-cards"><p>${datos.title}</p></div>
                </div>
                `
                contentCards.appendChild(cards);
};
};
});
};
</script>
<nav class="nav-modal-año" id="nav-modal-año">
    <div class="co-modal-año-title"><p>Categoria por año</p></div>
    <div class="co-modal-año">
        <div class="modal-año">
            <div class="co-año">
                <li class="filtro next" data-año="all"><a data="next" href="#">ALL</a></li>
                <li class="filtro next" data-año="2023"><a data="next" href="#">2023</a></li>
                <li class="filtro next" data-año="2022"><a data="next" href="#">2022</a></li>
                <li class="filtro next" data-año="2021"><a data="next" href="#">2021</a></li>
                <li class="filtro next" data-año="2020"><a data="next" href="#">2020</a></li>
                <li class="filtro next" data-año="2019"><a data="next" href="#">2019</a></li>
                
            </div>
        </div>
    </div>
</nav>

<script src="js/index.js"></script>

</body>
</html>
